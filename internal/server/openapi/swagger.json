{
    "schemes": [
        "http",
        "https"
    ],
    "swagger": "2.0",
    "info": {
        "description": "Corvo is a distributed background job queue. All endpoints are under `/api/v1`. Authentication via `X-API-Key` header or `Authorization: Bearer` token.",
        "title": "Corvo API",
        "contact": {
            "url": "https://corvohq.com"
        },
        "version": "v1"
    },
    "host": "localhost:8080",
    "basePath": "/api/v1",
    "paths": {
        "/ack/batch": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Worker"
                ],
                "summary": "Acknowledge multiple jobs",
                "parameters": [
                    {
                        "description": "Ack batch request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.AckBatchRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.AckedCountResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/ack/{job_id}": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Worker"
                ],
                "summary": "Acknowledge (complete) a job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "job_id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Ack body",
                        "name": "body",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/server.AckBody"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/approval-policies": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Approvals"
                ],
                "summary": "List approval policies",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/store.ApprovalPolicy"
                            }
                        }
                    }
                }
            },
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Configures human-in-the-loop review for jobs. Jobs matching the policy will be held awaiting approval before processing.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Approvals"
                ],
                "summary": "Create or update an approval policy",
                "parameters": [
                    {
                        "description": "Approval policy request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.SetApprovalPolicyRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.ApprovalPolicy"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/approval-policies/{id}": {
            "delete": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Approvals"
                ],
                "summary": "Delete an approval policy",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Policy ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/keys": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "List API keys",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "object"
                            }
                        }
                    }
                }
            },
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Create or update an API key",
                "parameters": [
                    {
                        "description": "API key request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.SetAPIKeyRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.SetAPIKeyResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "delete": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Delete an API key",
                "parameters": [
                    {
                        "description": "Delete API key request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.DeleteAPIKeyRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/status": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Auth configuration status",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    }
                }
            }
        },
        "/budgets": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Budgets"
                ],
                "summary": "List budgets",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/store.Budget"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Sets a spending cap for AI/agent jobs by queue or globally. Jobs exceeding the budget will be failed with BUDGET_EXCEEDED.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Budgets"
                ],
                "summary": "Create or update a budget",
                "parameters": [
                    {
                        "description": "Budget request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.SetBudgetRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.Budget"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/budgets/{scope}/{target}": {
            "delete": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Budgets"
                ],
                "summary": "Delete a budget",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Scope: queue or global",
                        "name": "scope",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Queue name or * for global",
                        "name": "target",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/bulk/{id}": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Bulk"
                ],
                "summary": "Get bulk operation status",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Bulk operation ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.bulkTask"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/bulk/{id}/progress": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "SSE stream for real-time progress updates on a bulk operation.",
                "produces": [
                    "text/event-stream"
                ],
                "tags": [
                    "Bulk"
                ],
                "summary": "Stream bulk operation progress",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Bulk operation ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "SSE progress stream"
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/cluster/events": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Cluster"
                ],
                "summary": "Cluster event log",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "Return events after this sequence number",
                        "name": "after_seq",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Max events to return (default: 100)",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    }
                }
            }
        },
        "/cluster/join": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Cluster"
                ],
                "summary": "Join a cluster node",
                "parameters": [
                    {
                        "description": "Join request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "type": "object"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/cluster/status": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Cluster"
                ],
                "summary": "Cluster status",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    }
                }
            }
        },
        "/enqueue": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Enqueue a job",
                "parameters": [
                    {
                        "description": "Enqueue request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.EnqueueRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Duplicate exists (unique_key)",
                        "schema": {
                            "$ref": "#/definitions/store.EnqueueResult"
                        }
                    },
                    "201": {
                        "description": "Job enqueued",
                        "schema": {
                            "$ref": "#/definitions/store.EnqueueResult"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "429": {
                        "description": "Rate limited or budget exceeded",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/enqueue/batch": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Enqueue a batch of jobs",
                "parameters": [
                    {
                        "description": "Batch enqueue request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.BatchEnqueueRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/store.BatchEnqueueResult"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/events": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Real-time event stream for job and queue state changes. Use last_event_id to resume.",
                "produces": [
                    "text/event-stream"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Server-Sent Events stream",
                "parameters": [
                    {
                        "type": "integer",
                        "description": "Resume from sequence number",
                        "name": "last_event_id",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "SSE stream"
                    }
                }
            }
        },
        "/fail/{job_id}": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Marks the job as failed. If retries remain it will be retried according to the backoff policy.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Worker"
                ],
                "summary": "Fail a job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "job_id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Fail body",
                        "name": "body",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/server.FailBody"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/fetch": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Long-polls until a job is available or timeout expires. Returns one job or 204 if none available.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Worker"
                ],
                "summary": "Fetch a job (long-poll)",
                "parameters": [
                    {
                        "description": "Fetch request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.FetchRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.FetchResult"
                        }
                    },
                    "204": {
                        "description": "No job available"
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/fetch/batch": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Long-polls until jobs are available or timeout expires. Returns up to count jobs.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Worker"
                ],
                "summary": "Fetch multiple jobs (long-poll)",
                "parameters": [
                    {
                        "description": "Fetch batch request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.FetchBatchRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.FetchBatchResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/healthz": {
            "get": {
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Health check",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "503": {
                        "description": "Service Unavailable",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/heartbeat": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Extends leases for active jobs. Can include progress and checkpoint data. Returns cancellation signals.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Worker"
                ],
                "summary": "Worker heartbeat",
                "parameters": [
                    {
                        "description": "Heartbeat request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/store.HeartbeatRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.HeartbeatResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/bulk": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Perform bulk actions by ID list or search filter. Supported actions: retry, delete, cancel, move, requeue, change_priority, hold, approve, reject.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Bulk"
                ],
                "summary": "Bulk operation on jobs",
                "parameters": [
                    {
                        "description": "Bulk request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.BulkWithAsyncRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.BulkResult"
                        }
                    },
                    "202": {
                        "description": "Async operation accepted",
                        "schema": {
                            "$ref": "#/definitions/server.BulkAsyncAcceptedResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/search": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Search jobs",
                "parameters": [
                    {
                        "description": "Search filter",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/search.Filter"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Get a job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/store.Job"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "delete": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Delete a job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/approve": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Approve a held job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/cancel": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Cancel a job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/hold": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Hold a job for approval",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/iterations": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Returns the iteration history for an agent job (AI loop tracking).",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "List agent iterations",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.IterationsResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/move": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Move a job to another queue",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Move request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.MoveJobRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/reject": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Reject a held job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/replay": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Re-enqueues the job from a specific iteration checkpoint.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Replay a completed job from an iteration",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Replay request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.ReplayJobRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/store.EnqueueResult"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/jobs/{id}/retry": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Retry a failed job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/metrics/throughput": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Real-time throughput stats",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    }
                }
            }
        },
        "/queues": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "List queues",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/store.QueueInfo"
                            }
                        }
                    }
                }
            }
        },
        "/queues/{name}": {
            "delete": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Deletes the queue and all its pending jobs.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Delete a queue",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    }
                }
            }
        },
        "/queues/{name}/clear": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Deletes all pending (non-active) jobs from the queue.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Clear all jobs from a queue",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    }
                }
            }
        },
        "/queues/{name}/concurrency": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Limits the number of jobs from this queue that can be active (in-flight) at once.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Set queue concurrency limit",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Concurrency request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.SetConcurrencyRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/queues/{name}/drain": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Stops new jobs from being fetched while allowing in-flight jobs to complete.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Drain a queue",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/queues/{name}/pause": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Paused queues stop dispatching jobs to workers. In-flight jobs continue.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Pause a queue",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/queues/{name}/resume": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Resume a paused queue",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/queues/{name}/throttle": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Limits the rate at which jobs are dispatched from the queue.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Set queue rate throttle",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Throttle request",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.SetThrottleRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "delete": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Queues"
                ],
                "summary": "Remove queue throttle",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/server.StatusResponse"
                        }
                    }
                }
            }
        },
        "/search/fulltext": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Searches job payloads, tags, and queue names using SQLite FTS or LIKE fallback.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Full-text search jobs",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Search query",
                        "name": "q",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "integer",
                        "description": "Max results (default: 50, max: 500)",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/usage/summary": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Returns aggregate token and cost data for AI/agent jobs.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Budgets"
                ],
                "summary": "Token and cost usage summary",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Time period (e.g. 24h, 168h)",
                        "name": "period",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Group by field",
                        "name": "group_by",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/webhooks": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "List webhooks",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/server.webhookConfig"
                            }
                        }
                    }
                }
            },
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Create or update a webhook",
                "parameters": [
                    {
                        "description": "Webhook config",
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.webhookConfig"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/webhooks/{id}": {
            "delete": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "Delete a webhook",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Webhook ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/webhooks/{queue}": {
            "post": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "description": "Enqueues a job using the raw HTTP body as payload. Useful for receiving webhooks from third-party services.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Enqueue via webhook",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Queue name",
                        "name": "queue",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Priority: low, normal, high, critical",
                        "name": "priority",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Deduplication key",
                        "name": "unique_key",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Max retry attempts",
                        "name": "max_retries",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "RFC3339 schedule time",
                        "name": "scheduled_at",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Tags as comma-separated key:value pairs",
                        "name": "tags",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Duplicate exists (unique_key)",
                        "schema": {
                            "$ref": "#/definitions/store.EnqueueResult"
                        }
                    },
                    "201": {
                        "description": "Job enqueued",
                        "schema": {
                            "$ref": "#/definitions/store.EnqueueResult"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/workers": {
            "get": {
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "System"
                ],
                "summary": "List connected workers",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "object"
                            }
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "search.Filter": {
            "type": "object",
            "properties": {
                "attempt_max": {
                    "type": "integer"
                },
                "attempt_min": {
                    "type": "integer"
                },
                "batch_id": {
                    "type": "string"
                },
                "chain_id": {
                    "type": "string"
                },
                "completed_after": {
                    "type": "string"
                },
                "completed_before": {
                    "type": "string"
                },
                "created_after": {
                    "type": "string"
                },
                "created_before": {
                    "type": "string"
                },
                "cursor": {
                    "type": "string"
                },
                "error_contains": {
                    "type": "string"
                },
                "expire_after": {
                    "type": "string"
                },
                "expire_before": {
                    "type": "string"
                },
                "has_errors": {
                    "type": "boolean"
                },
                "job_id_prefix": {
                    "type": "string"
                },
                "limit": {
                    "type": "integer"
                },
                "order": {
                    "type": "string"
                },
                "parent_id": {
                    "type": "string"
                },
                "payload_contains": {
                    "type": "string"
                },
                "payload_jq": {
                    "type": "string"
                },
                "priority": {
                    "type": "string"
                },
                "queue": {
                    "type": "string"
                },
                "scheduled_after": {
                    "type": "string"
                },
                "scheduled_before": {
                    "type": "string"
                },
                "sort": {
                    "type": "string"
                },
                "started_after": {
                    "type": "string"
                },
                "started_before": {
                    "type": "string"
                },
                "state": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "tags": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "unique_key": {
                    "type": "string"
                },
                "worker_id": {
                    "type": "string"
                }
            }
        },
        "server.AckBatchItem": {
            "type": "object",
            "properties": {
                "job_id": {
                    "type": "string"
                },
                "result": {
                    "type": "string"
                },
                "usage": {
                    "$ref": "#/definitions/store.UsageReport"
                }
            }
        },
        "server.AckBatchRequest": {
            "type": "object",
            "properties": {
                "acks": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/server.AckBatchItem"
                    }
                }
            }
        },
        "server.AckBody": {
            "type": "object",
            "properties": {
                "agent_status": {
                    "type": "string"
                },
                "checkpoint": {
                    "type": "string"
                },
                "exit_reason": {
                    "type": "string"
                },
                "hold_reason": {
                    "type": "string"
                },
                "result": {
                    "type": "string"
                },
                "step_status": {
                    "type": "string"
                },
                "usage": {
                    "$ref": "#/definitions/store.UsageReport"
                }
            }
        },
        "server.AckedCountResponse": {
            "type": "object",
            "properties": {
                "acked": {
                    "type": "integer"
                }
            }
        },
        "server.BulkAsyncAcceptedResponse": {
            "type": "object",
            "properties": {
                "bulk_operation_id": {
                    "type": "string"
                },
                "estimated_total": {
                    "type": "integer"
                },
                "progress_url": {
                    "type": "string"
                },
                "status": {
                    "type": "string"
                }
            }
        },
        "server.BulkWithAsyncRequest": {
            "type": "object",
            "properties": {
                "action": {
                    "description": "retry, delete, cancel, move, requeue, change_priority, hold, approve, reject",
                    "type": "string"
                },
                "async": {
                    "type": "boolean"
                },
                "filter": {
                    "$ref": "#/definitions/search.Filter"
                },
                "job_ids": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "move_to_queue": {
                    "type": "string"
                },
                "priority": {
                    "type": "string"
                }
            }
        },
        "server.DeleteAPIKeyRequest": {
            "type": "object",
            "properties": {
                "key_hash": {
                    "type": "string"
                }
            }
        },
        "server.ErrorResponse": {
            "type": "object",
            "properties": {
                "code": {
                    "type": "string"
                },
                "error": {
                    "type": "string"
                }
            }
        },
        "server.FailBody": {
            "type": "object",
            "properties": {
                "backtrace": {
                    "type": "string"
                },
                "error": {
                    "type": "string"
                }
            }
        },
        "server.FetchBatchRequest": {
            "type": "object",
            "properties": {
                "count": {
                    "type": "integer"
                },
                "hostname": {
                    "type": "string"
                },
                "queues": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "timeout": {
                    "type": "integer"
                },
                "worker_id": {
                    "type": "string"
                }
            }
        },
        "server.FetchBatchResponse": {
            "type": "object",
            "properties": {
                "jobs": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/store.FetchResult"
                    }
                }
            }
        },
        "server.IterationsResponse": {
            "type": "object",
            "properties": {
                "iterations": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/store.JobIteration"
                    }
                }
            }
        },
        "server.MoveJobRequest": {
            "type": "object",
            "properties": {
                "queue": {
                    "type": "string"
                }
            }
        },
        "server.ReplayJobRequest": {
            "type": "object",
            "properties": {
                "from": {
                    "type": "integer"
                }
            }
        },
        "server.SetAPIKeyRequest": {
            "type": "object",
            "properties": {
                "enabled": {
                    "type": "boolean"
                },
                "expires_at": {
                    "type": "string"
                },
                "key": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "namespace": {
                    "type": "string"
                },
                "queue_scope": {
                    "type": "string"
                },
                "role": {
                    "type": "string"
                }
            }
        },
        "server.SetAPIKeyResponse": {
            "type": "object",
            "properties": {
                "api_key": {
                    "type": "string"
                },
                "status": {
                    "type": "string"
                }
            }
        },
        "server.SetConcurrencyRequest": {
            "type": "object",
            "properties": {
                "max": {
                    "type": "integer"
                }
            }
        },
        "server.SetThrottleRequest": {
            "type": "object",
            "properties": {
                "rate": {
                    "type": "integer"
                },
                "window_ms": {
                    "type": "integer"
                }
            }
        },
        "server.StatusResponse": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "string"
                }
            }
        },
        "server.bulkTask": {
            "type": "object",
            "properties": {
                "action": {
                    "type": "string"
                },
                "affected": {
                    "type": "integer"
                },
                "created_at": {
                    "type": "string"
                },
                "error": {
                    "type": "string"
                },
                "errors": {
                    "type": "integer"
                },
                "finished_at": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "processed": {
                    "type": "integer"
                },
                "status": {
                    "$ref": "#/definitions/server.bulkTaskStatus"
                },
                "total": {
                    "type": "integer"
                },
                "updated_at": {
                    "type": "string"
                }
            }
        },
        "server.bulkTaskStatus": {
            "type": "string",
            "enum": [
                "queued",
                "running",
                "completed",
                "failed"
            ],
            "x-enum-varnames": [
                "bulkTaskQueued",
                "bulkTaskRunning",
                "bulkTaskCompleted",
                "bulkTaskFailed"
            ]
        },
        "server.webhookConfig": {
            "type": "object",
            "properties": {
                "created_at": {
                    "type": "string"
                },
                "enabled": {
                    "type": "boolean"
                },
                "events": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "id": {
                    "type": "string"
                },
                "last_delivery_at": {
                    "type": "string"
                },
                "last_error": {
                    "type": "string"
                },
                "last_status_code": {
                    "type": "integer"
                },
                "retry_limit": {
                    "type": "integer"
                },
                "secret": {
                    "type": "string"
                },
                "url": {
                    "type": "string"
                }
            }
        },
        "store.AgentConfig": {
            "type": "object",
            "properties": {
                "iteration_timeout": {
                    "type": "string"
                },
                "max_cost_usd": {
                    "type": "number"
                },
                "max_iterations": {
                    "type": "integer"
                }
            }
        },
        "store.AgentState": {
            "type": "object",
            "properties": {
                "iteration": {
                    "type": "integer"
                },
                "iteration_timeout": {
                    "type": "string"
                },
                "max_cost_usd": {
                    "type": "number"
                },
                "max_iterations": {
                    "type": "integer"
                },
                "total_cost_usd": {
                    "type": "number"
                }
            }
        },
        "store.ApprovalPolicy": {
            "type": "object",
            "properties": {
                "created_at": {
                    "type": "string"
                },
                "enabled": {
                    "type": "boolean"
                },
                "id": {
                    "type": "string"
                },
                "mode": {
                    "description": "any|all",
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "queue": {
                    "type": "string"
                },
                "tag_key": {
                    "type": "string"
                },
                "tag_value": {
                    "type": "string"
                }
            }
        },
        "store.BatchConfig": {
            "type": "object",
            "properties": {
                "callback_payload": {
                    "type": "string"
                },
                "callback_queue": {
                    "type": "string"
                }
            }
        },
        "store.BatchEnqueueRequest": {
            "type": "object",
            "properties": {
                "batch": {
                    "$ref": "#/definitions/store.BatchConfig"
                },
                "jobs": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/store.EnqueueRequest"
                    }
                }
            }
        },
        "store.BatchEnqueueResult": {
            "type": "object",
            "properties": {
                "batch_id": {
                    "type": "string"
                },
                "job_ids": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "store.Budget": {
            "type": "object",
            "properties": {
                "created_at": {
                    "type": "string"
                },
                "daily_usd": {
                    "type": "number"
                },
                "id": {
                    "type": "string"
                },
                "on_exceed": {
                    "type": "string"
                },
                "per_job_usd": {
                    "type": "number"
                },
                "scope": {
                    "type": "string"
                },
                "target": {
                    "type": "string"
                }
            }
        },
        "store.BulkResult": {
            "type": "object",
            "properties": {
                "affected": {
                    "type": "integer"
                },
                "duration_ms": {
                    "type": "integer"
                },
                "errors": {
                    "type": "integer"
                }
            }
        },
        "store.ChainDefinition": {
            "type": "object",
            "properties": {
                "on_exit": {
                    "$ref": "#/definitions/store.ChainStep"
                },
                "on_failure": {
                    "$ref": "#/definitions/store.ChainStep"
                },
                "steps": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/store.ChainStep"
                    }
                }
            }
        },
        "store.ChainStep": {
            "type": "object",
            "properties": {
                "payload": {
                    "type": "string"
                },
                "queue": {
                    "type": "string"
                }
            }
        },
        "store.EnqueueRequest": {
            "type": "object",
            "properties": {
                "agent": {
                    "$ref": "#/definitions/store.AgentConfig"
                },
                "chain": {
                    "$ref": "#/definitions/store.ChainDefinition"
                },
                "chain_config": {
                    "type": "string"
                },
                "chain_id": {
                    "type": "string"
                },
                "chain_step": {
                    "type": "integer"
                },
                "checkpoint": {
                    "type": "string"
                },
                "depends_on": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "expire_after": {
                    "description": "e.g. \"1h\"",
                    "type": "string"
                },
                "max_retries": {
                    "type": "integer"
                },
                "parent_id": {
                    "type": "string"
                },
                "payload": {
                    "type": "string"
                },
                "priority": {
                    "type": "string"
                },
                "queue": {
                    "type": "string"
                },
                "retry_backoff": {
                    "type": "string"
                },
                "retry_base_delay": {
                    "description": "e.g. \"5s\"",
                    "type": "string"
                },
                "retry_max_delay": {
                    "description": "e.g. \"10m\"",
                    "type": "string"
                },
                "scheduled_at": {
                    "type": "string"
                },
                "tags": {
                    "type": "string"
                },
                "unique_key": {
                    "type": "string"
                },
                "unique_period": {
                    "description": "seconds",
                    "type": "integer"
                }
            }
        },
        "store.EnqueueResult": {
            "type": "object",
            "properties": {
                "job_id": {
                    "type": "string"
                },
                "status": {
                    "type": "string"
                },
                "unique_existing": {
                    "type": "boolean"
                }
            }
        },
        "store.FetchRequest": {
            "type": "object",
            "properties": {
                "hostname": {
                    "type": "string"
                },
                "queues": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "timeout": {
                    "description": "seconds, default 60",
                    "type": "integer"
                },
                "worker_id": {
                    "type": "string"
                }
            }
        },
        "store.FetchResult": {
            "type": "object",
            "properties": {
                "agent": {
                    "$ref": "#/definitions/store.AgentState"
                },
                "attempt": {
                    "type": "integer"
                },
                "checkpoint": {
                    "type": "string"
                },
                "job_id": {
                    "type": "string"
                },
                "lease_duration": {
                    "type": "integer"
                },
                "max_retries": {
                    "type": "integer"
                },
                "payload": {
                    "type": "string"
                },
                "queue": {
                    "type": "string"
                },
                "tags": {
                    "type": "string"
                }
            }
        },
        "store.HeartbeatJobResponse": {
            "type": "object",
            "properties": {
                "budget_exceeded": {
                    "description": "soft signal to wrap up",
                    "type": "boolean"
                },
                "status": {
                    "description": "\"ok\" or \"cancel\"",
                    "type": "string"
                }
            }
        },
        "store.HeartbeatJobUpdate": {
            "type": "object",
            "properties": {
                "checkpoint": {
                    "type": "object",
                    "additionalProperties": true
                },
                "progress": {
                    "type": "object",
                    "additionalProperties": true
                },
                "usage": {
                    "$ref": "#/definitions/store.UsageReport"
                }
            }
        },
        "store.HeartbeatRequest": {
            "type": "object",
            "properties": {
                "jobs": {
                    "type": "object",
                    "additionalProperties": {
                        "$ref": "#/definitions/store.HeartbeatJobUpdate"
                    }
                }
            }
        },
        "store.HeartbeatResponse": {
            "type": "object",
            "properties": {
                "jobs": {
                    "type": "object",
                    "additionalProperties": {
                        "$ref": "#/definitions/store.HeartbeatJobResponse"
                    }
                }
            }
        },
        "store.Job": {
            "type": "object",
            "properties": {
                "agent": {
                    "$ref": "#/definitions/store.AgentState"
                },
                "attempt": {
                    "type": "integer"
                },
                "batch_id": {
                    "type": "string"
                },
                "chain_config": {
                    "type": "string"
                },
                "chain_id": {
                    "type": "string"
                },
                "chain_step": {
                    "type": "integer"
                },
                "checkpoint": {
                    "type": "string"
                },
                "completed_at": {
                    "type": "string"
                },
                "created_at": {
                    "type": "string"
                },
                "errors": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/store.JobError"
                    }
                },
                "expire_at": {
                    "type": "string"
                },
                "failed_at": {
                    "type": "string"
                },
                "hold_reason": {
                    "type": "string"
                },
                "hostname": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "lease_expires_at": {
                    "type": "string"
                },
                "max_retries": {
                    "type": "integer"
                },
                "parent_id": {
                    "type": "string"
                },
                "payload": {
                    "type": "string"
                },
                "priority": {
                    "type": "integer"
                },
                "progress": {
                    "type": "string"
                },
                "provider_error": {
                    "type": "boolean"
                },
                "queue": {
                    "type": "string"
                },
                "result": {
                    "type": "string"
                },
                "retry_backoff": {
                    "type": "string"
                },
                "retry_base_delay_ms": {
                    "type": "integer"
                },
                "retry_max_delay_ms": {
                    "type": "integer"
                },
                "scheduled_at": {
                    "type": "string"
                },
                "started_at": {
                    "type": "string"
                },
                "state": {
                    "type": "string"
                },
                "tags": {
                    "type": "string"
                },
                "unique_key": {
                    "type": "string"
                },
                "worker_id": {
                    "type": "string"
                }
            }
        },
        "store.JobError": {
            "type": "object",
            "properties": {
                "attempt": {
                    "type": "integer"
                },
                "backtrace": {
                    "type": "string"
                },
                "created_at": {
                    "type": "string"
                },
                "error": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "job_id": {
                    "type": "string"
                }
            }
        },
        "store.JobIteration": {
            "type": "object",
            "properties": {
                "cache_creation_tokens": {
                    "type": "integer"
                },
                "cache_read_tokens": {
                    "type": "integer"
                },
                "checkpoint": {
                    "type": "string"
                },
                "cost_usd": {
                    "type": "number"
                },
                "created_at": {
                    "type": "string"
                },
                "hold_reason": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "input_tokens": {
                    "type": "integer"
                },
                "iteration": {
                    "type": "integer"
                },
                "job_id": {
                    "type": "string"
                },
                "model": {
                    "type": "string"
                },
                "output_tokens": {
                    "type": "integer"
                },
                "provider": {
                    "type": "string"
                },
                "result": {
                    "type": "string"
                },
                "status": {
                    "type": "string"
                }
            }
        },
        "store.QueueInfo": {
            "type": "object",
            "properties": {
                "active": {
                    "type": "integer"
                },
                "completed": {
                    "type": "integer"
                },
                "created_at": {
                    "type": "string"
                },
                "dead": {
                    "type": "integer"
                },
                "enqueued": {
                    "type": "integer"
                },
                "failed": {
                    "type": "integer"
                },
                "held": {
                    "type": "integer"
                },
                "max_concurrency": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "oldest_pending_at": {
                    "type": "string"
                },
                "paused": {
                    "type": "boolean"
                },
                "pending": {
                    "type": "integer"
                },
                "rate_limit": {
                    "type": "integer"
                },
                "rate_window_ms": {
                    "type": "integer"
                },
                "retrying": {
                    "type": "integer"
                },
                "scheduled": {
                    "type": "integer"
                }
            }
        },
        "store.SetApprovalPolicyRequest": {
            "type": "object",
            "properties": {
                "enabled": {
                    "type": "boolean"
                },
                "mode": {
                    "description": "any|all",
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "queue": {
                    "type": "string"
                },
                "tag_key": {
                    "type": "string"
                },
                "tag_value": {
                    "type": "string"
                }
            }
        },
        "store.SetBudgetRequest": {
            "type": "object",
            "properties": {
                "daily_usd": {
                    "type": "number"
                },
                "on_exceed": {
                    "type": "string"
                },
                "per_job_usd": {
                    "type": "number"
                },
                "scope": {
                    "type": "string"
                },
                "target": {
                    "type": "string"
                }
            }
        },
        "store.UsageReport": {
            "type": "object",
            "properties": {
                "cache_creation_tokens": {
                    "type": "integer"
                },
                "cache_read_tokens": {
                    "type": "integer"
                },
                "cost_usd": {
                    "type": "number"
                },
                "input_tokens": {
                    "type": "integer"
                },
                "model": {
                    "type": "string"
                },
                "output_tokens": {
                    "type": "integer"
                },
                "provider": {
                    "type": "string"
                }
            }
        }
    },
    "securityDefinitions": {
        "ApiKeyAuth": {
            "type": "apiKey",
            "name": "X-API-Key",
            "in": "header"
        },
        "BearerAuth": {
            "description": "Bearer token: `Authorization: Bearer \u003ctoken\u003e`",
            "type": "apiKey",
            "name": "Authorization",
            "in": "header"
        }
    }
}